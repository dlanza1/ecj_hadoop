\label{resultados-facerecognition}

Aclaramos en primer lugar que los experimentos y resultados se han realizado para medir los tiempos de cómputo, queda fuera del alcance del trabajo analizar la calidad de los resultados obtenidos mediante la implementación evolutiva, es decir, no valoraremos si la aplicaci\'on del algoritmo evolutivo ha mejorado la capacidad de reconocimiento facial del sistema, pero si entraremos a valorar el tiempo de ejecuci\'on al ejecutar el algoritmo evolutivo en diferentes escenarios.

Analizamos los resultados obtenidos al ejecutar un problema en el que la evaluación de cada individuo toma varios minutos. En una ejecuci\'on secuencial, los tiempos de la evaluación de cada generaraci\'on puede llevar horas dependiendo del tamaño de la población.

La implementaci\'on secuencial del algoritmo de reconocimiento facial utiliza la librer\'ia OpenCV para el tratamiento de las im\'agenes. El uso de esta librer\'ia ayuda a reducir notablemente el tiempo de procesamiento, as\'i la fase de entrenamiento en la ejecuci\'on secuencial necesita sobre unos 127 segundos y la fase de consulta unos 140 segundos. 

En primer lugar se realiz\'o la integraci\'on del problema de reconocimiento facial con Hadoop para paralelizar el procesamiento de las im\'agenes haciendo uso de esta herramienta. El nivel de paralelizaci\'on depende de c\'omo se divida la entrada del problema ya que se ejecutar\'an tantas tareas en paralelo como divisiones de la entrada existan \ver{fases-evaluacion-trabajo-por-ind}. Esta idea nos podr\'ia llevar al convencimiento de que obtendremos mejores tiempos mientras m\'as tareas tengamos, pero la creaci\'on de la tarea, distribuci\'on de la entrada al trabajo y la posterior destrucci\'on de la tarea conllevan tiempos que deben ser considerados. Es por esto que se han realizado ejecuciones para encontrar el mejor n\'umero de tareas que se ejecuten de forma paralela. Los tiempos obtenidos en segundos se muestran en una tabla \vertabla{tabla-tiempos-num-grupos}.

\begin{table}[H]
  \begin{center}
    \begin{center}
    \begin{tabular}{l | c c c c c c}
    Grupos & 10 & 15 & 20 & 25 & 30 & 40 \\ \hline
    Entrenamiento (s) & 63 & 42 & 39 & 41 & 45 & 30\\
    Consulta (s) & 57 & 46 & 43 & 46 & 50 & 54\\
    \end{tabular}
    \end{center}
    \caption{Tiempos de ejecución en Hadoop en funci\'on del n\'umero de grupos}
    \label{tabla-tiempos-num-grupos}
  \end{center}
\end{table}

Si graficamos estos resultados \ver{grafica-num-grupos} compar\'andolos con los tiempos de la ejecuci\'on secuencial podemos observar facilmente dos situaciones. En primer lugar, el hecho de que el n\'umero de grupos m\'as apropiado en el que se debe dividir la entrada son 20. Por otro lado vemos como la ganancia de tiempo con respecto a la ejecuci\'on secuencial es significativa. Si sumamos los tiempos de ambas fases en ambas implementaciones (tiempos con 20 grupos) y los comparamos, vemos como la integraci\'on ha conseguido que se ejecute el algoritmo en un 30\% del tiempo de la ejecuci\'on secuencial.

\figuraSinMarco{0.8}{imagenes/facerecognition-results-num-splits}{Comparaci\'on de tiempos en funci\'on del numero de grupos de la entrada}{grafica-num-grupos}{}

Tras la integraci\'on con Hadoop, se procedi\'o con la adaptaci\'on del algoritmo de reconocimiento facial a un algoritmo evolutivo utilizando ECJ. Esta integraci\'on provoca que cada individuo de la poblaci\'on ejecute dos trabajos, el de entrenamiento y consulta, y todos ellos de forma paralela por lo que se produce otro nivel de paralelizaci\'on. 

Con el fin de probar la escalabilidad del sistema se ha lanzado ejecuciones con diferentes n\'umero de nodos y el mismo n\'umero de individuos (10) registrando los tiempos obtenidos \vertabla{tabla-dif-num-nodos}.

\begin{table}[H]
  \begin{center}
    \begin{center}
    \begin{tabular}{l | c c c c}
    N\'umero de nodos & 1 & 2 & 4 & 6 \\ \hline
    Evaluaci\'on (min) & 53 & 25 & 11.5 & 6.4\\
    \end{tabular}
    \end{center}
    \caption{Tiempos de evaluaci\'on de la poblaci\'on en Hadoop con diferente n\'umero de nodos para 10 individuos}
    \label{tabla-dif-num-nodos}
  \end{center}
\end{table}

\figuraSinMarco{0.6}{imagenes/facerecognition-results-num-nodes}{Comparaci\'on de tiempos en funci\'on del n\'umero de nodos}{grafica-num-nodos}{}

Graficados estos datos \ver{grafica-num-nodos} observamos la escalabilidad del sistema, los resultados nos indican que la inclusi\'on de nuevos nodos en el cluster en el que lo corramos (f\'acil tarea) provocar\'a que los tiempos se reducir\'an acorde al n\'umero de nodos que a\~nadamos. Para observar mejor la escalabilidad del sistema se ha a\~nadido una l\'inea de tiempo ideal correspondiente a la mitad del tiempo de 1 nodo para 2 nodos, a la cuarta parte para 4 nodos y a la sexta parte para 6 nodos. Adem\'as, se ha a\~nadido al gr\'afico el tiempo que tomar\'ia esta ejecuci\'on de forma secuencial (evaluar un individuo {= 127 + 140 = 267 s}, evaluar 10 {= 10 x 267 / 60 = 44.5 min}) para observar lo que supone el uso de Hadoop.

El hecho de que se mejoren los tiempos ideales es de extra\~nar, pero debemos tener en cuenta que Hadoop hace uso de numerosos servicios que se pueden ver sobrecargados si todo se ejecuta en un n\'umero reducido de nodos. Por esta raz\'on es f\'acil que se produzcan este tipo de anomal\'ias en los tiempos analizados.

Analizamos ahora ejecuciones con diferentes tama\~nos de poblaci\'on y el mismo n\'umero de nodos (6). Se espera que los tiempos de evaluaci\'on sean directamente proporcionales al tama\~no de la poblaci\'on.

\begin{table}[H]
  \begin{center}
    \begin{center}
    \begin{tabular}{l | c c c c}
    N\'umero de individuos & 10 & 20 & 30 \\ \hline
    Evaluaci\'on (min) & 6.4 & 14.5 & 22.1 \\
    \end{tabular}
    \end{center}
    \caption{Tiempos de evaluaci\'on de la poblaci\'on en Hadoop con diferente n\'umero de individuos en 6 nodos}
    \label{tabla-dif-num-indiv}
  \end{center}
\end{table}

\figuraSinMarco{0.6}{imagenes/facerecognition-results-num-indiv}{Comparaci\'on de tiempos en funci\'on del n\'umero de individuos}{grafica-num-indiv}{}

Al igual que hemos hecho con los resultados anteriores, lo comparamos con los tiempos de ejecuciones secuenciales y tiempos ideales \ver{grafica-num-indiv}. Vemos como los beneficios del uso de la integraci\'on con Hadoop son significativos, adem\'as se obtienen resultados similares a los ideales.

Los resultados obtenidos han sido realmente prometedores, la reducci\'on de los tiempos ha sido considerable y vemos como la escalabilidad del sistema es indiscutible. Con un cluster con m\'as nodos, se podr\'ian utilizar poblaciones m\'as grandes y a\'un as\'i mantener el tiempo de ejecuci\'on en pocos minutos. Basicamente, duplicando la poblaci\'on y el n\'umero de nodos, los tiempos ser\'ian los mismos, hecho remarcable en un sistema paralelo.












